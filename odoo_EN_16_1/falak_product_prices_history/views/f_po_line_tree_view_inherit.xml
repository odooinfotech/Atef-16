
<odoo>
	<record id="f_view_purchase_order_form" model="ir.ui.view">
		<field name="name">f.purchase.order.line.price.history.form</field>
		<field name="model">purchase.order</field>
		<field name="inherit_id" ref="purchase.purchase_order_form" />
		<field name="arch" type="xml">
			<xpath expr="//field[@name='order_line']/tree">
				<field name="partner_id" invisible="1" />
			</xpath>
			<xpath expr="//field[@name='order_line']//tree//field[@name='price_unit']" position="before">
				<field name="f_purchase_history" invisible="1" />
				<button name="f_open_price_history"
				    string=" "
				    type="object"
				    icon="fa-history"
				    context="{'partner_id': partner_id, 'product_id': product_id, 'order_line_id': id}"
				    attrs="{'invisible': ['|','|',('parent.invoice_status', 'in', ('no', 'to invoice')),('parent.invoice_status', '=', 'invoiced'),('f_purchase_history','=',False)]}"
					groups="hide_product_cost.f_cost_group_id"/>
				<button name="f_open_price_history"
				    string=" "
				    type="object"
				    icon="fa-history"
				    context="{'partner_id': partner_id, 'product_id': product_id, 'order_line_id': id}"
				    attrs="{'invisible': ['|','|',('parent.invoice_status', '=', 'invoiced'), ('parent.state', '=', 'done'),('f_purchase_history','=',False)]}"
					groups="hide_product_cost.f_cost_group_id"/>
			</xpath>
		</field>
	</record>
</odoo>